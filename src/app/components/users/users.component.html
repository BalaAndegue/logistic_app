<!-- src/app/components/users/users.component.html -->
<div class="users-management">
    <div class="header">
        <h2>User Management</h2>
        <button class="btn btn-primary" (click)="onAddUser()" *ngIf="canManageUsers()">
            <i class="bi bi-plus-circle"></i> Add User
        </button>
    </div>

    <!-- Statistiques -->
    <div class="stats-cards" *ngIf="stats">
        <div class="stat-card" *ngFor="let role of ['admin', 'manager', 'supervisor', 'user']">
            <div class="stat-value">{{ getRoleCount(role) }}</div>
            <div class="stat-label">{{ role | titlecase }}</div>
        </div>
    </div>

    <!-- Barre de recherche et filtres -->
    <div class="controls">
        <div class="search-box">
            <input type="text" [(ngModel)]="searchQuery" placeholder="Search users..." (keyup.enter)="onSearch()">
            <button class="btn btn-secondary" (click)="onSearch()">Search</button>
        </div>
        
        <div class="filters">
            <select [(ngModel)]="selectedRole" (change)="onFilterByRole(selectedRole)">
                <option value="">All Roles</option>
                <option value="admin">Admin</option>
                <option value="manager">Manager</option>
                <option value="supervisor">Supervisor</option>
                <option value="user">User</option>
            </select>
        </div>
    </div>

    <!-- Liste des utilisateurs -->
    <app-user-list 
        [users]="users" 
        [loading]="loading" 
        [canManage]="canManageUsers()"
        (edit)="onEditUser($event)"
        (delete)="onDeleteUser($event)">
    </app-user-list>

    <!-- Pagination -->
    <div class="pagination" *ngIf="totalPages > 1">
        <button [disabled]="currentPage === 1" (click)="onChangePage(currentPage - 1)">
            Previous
        </button>
        <span>Page {{ currentPage }} of {{ totalPages }}</span>
        <button [disabled]="currentPage === totalPages" (click)="onChangePage(currentPage + 1)">
            Next
        </button>
    </div>

    <!-- Formulaire (modal) -->
    <div class="modal-overlay" *ngIf="showForm">
        <div class="modal">
            <app-user-form 
                [user]="selectedUser"
                [isEditing]="isEditing"
                (submit)="onFormSubmit($event)"
                (cancel)="onFormCancel()">
            </app-user-form>
        </div>
    </div>
</div>